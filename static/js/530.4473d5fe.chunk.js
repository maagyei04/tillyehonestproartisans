"use strict";(self.webpackChunktillyehonestproartisans=self.webpackChunktillyehonestproartisans||[]).push([[530],{9530:(e,s,t)=>{t.r(s),t.d(s,{default:()=>R});var r=t(9950),l=t(3464),a=t(33),c=t(8170),o=t(2053),n=t(9739),d=t(226),i=t(5336),x=t(300),m=t(1032),u=t(297),h=t(1320),g=t(2235),p=t(5769),j=t(9780),b=t(9213),y=t(1671),f=t(4075),N=t(2825),w=t(9818),v=t(7075),A=t(4414);const k=e=>void 0===e?"":e instanceof v.Dc?new Date(1e3*e.seconds).toLocaleDateString():e.toDate().toLocaleDateString(),C=()=>{const[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(1),[a,c]=(0,r.useState)(!1),[n,d]=(0,r.useState)(null),[x,u]=(0,r.useState)(!1),{currentUser:v,userLoggedIn:C}=(0,m.A)(),S=C&&v?v.uid:null;(0,r.useEffect)((()=>{S&&(0,i.Et)(S).then((e=>{s(e),console.log(e)})).catch((e=>{console.error("Error fetching orders:",e)}))}),[S]);const P=Array.isArray(e)?e.slice(10*(t-1),10*t):[];console.log(P);return(0,A.jsxs)("div",{className:"",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)(o.A,{variant:"h2",gutterBottom:!0,className:"font-bold text-xl",children:"Recent Orders"}),(0,A.jsx)(h.A,{component:g.A,sx:{marginTop:4,overflowX:"auto"},children:(0,A.jsxs)(p.A,{"aria-label":"responsive table",children:[(0,A.jsx)(j.A,{className:"bg-gray-200",children:(0,A.jsxs)(b.A,{children:[(0,A.jsx)(y.A,{children:"Buyer Name"}),(0,A.jsx)(y.A,{children:"Buyer Phone"}),(0,A.jsx)(y.A,{children:"Date"}),(0,A.jsx)(y.A,{children:"Product (Qty)"}),(0,A.jsx)(y.A,{children:"Total Amt"}),(0,A.jsx)(y.A,{children:"Total Qty"}),(0,A.jsx)(y.A,{children:"Payment Status"}),(0,A.jsx)(y.A,{children:"Delivery Option"}),(0,A.jsx)(y.A,{children:"Action"})]})}),(0,A.jsx)(f.A,{children:P.length>0?P.map(((e,s)=>(0,A.jsxs)(b.A,{children:[(0,A.jsx)(y.A,{className:"text-gray-500",children:e.buyerName}),(0,A.jsx)(y.A,{className:"text-gray-500",children:e.buyerPhone}),(0,A.jsx)(y.A,{className:"text-gray-500",children:k(e.dateOrdered)}),(0,A.jsx)(y.A,{className:"text-gray-500",children:Array.isArray(e.items)?e.items.map(((e,s)=>(0,A.jsxs)("div",{children:[e.productName," (",e.quantity,")"]},s))):"No items"}),(0,A.jsxs)(y.A,{className:"text-gray-500",children:["GHc ",e.totalAmount]}),(0,A.jsx)(y.A,{className:"text-gray-500",children:e.totalQuantity}),(0,A.jsx)(y.A,{className:"text-gray-500",children:e.paymentStatus}),(0,A.jsx)(y.A,{className:"text-gray-500",children:e.deliveryOption}),(0,A.jsxs)(y.A,{children:[(0,A.jsx)("button",{className:"bg-red-500 text-white px-2 py-1 rounded",onClick:()=>(d(e),void c(!0)),children:"Delete Order"}),(0,A.jsx)("button",{className:"bg-blue-500 text-white px-2 py-1 rounded ml-3",onClick:()=>(d(e),void u(!0)),children:"View Order"})]})]},s))):(0,A.jsx)(b.A,{children:(0,A.jsx)(y.A,{colSpan:5,children:(0,A.jsxs)("div",{className:"flex flex-col items-center justify-center mt-10",children:[(0,A.jsx)(w.A,{className:"h-10",style:{color:"gray"}}),(0,A.jsx)("p",{className:"font-bold text-lg",children:"You've no financial history"}),(0,A.jsx)(o.A,{className:"text-gray-500 mt-2 text-center px-2 md:px-20",children:"You're all set! There are currently no records of payment. Enjoy your free time or use it to tackle your next task with peace of mind."})]})})})})]})})]}),(0,A.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,A.jsx)("button",{className:"bg-gray-200 text-gray-700 py-2 px-4 rounded",onClick:()=>l(t-1),disabled:1===t,children:"Previous"}),(0,A.jsx)("div",{className:"flex space-x-2",children:(0,A.jsx)(N.A,{count:Math.ceil(e.length/10),page:t,onChange:(e,s)=>{l(s)},color:"primary"})}),(0,A.jsx)("button",{className:"bg-gray-200 text-gray-700 py-2 px-4 rounded",onClick:()=>l(t+1),disabled:t===Math.ceil(e.length/10),children:"Next"})]}),a&&(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50",children:(0,A.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,A.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Delete Order"}),(0,A.jsx)("p",{children:"Are you sure you want to delete this order?"}),(0,A.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,A.jsx)("button",{className:"bg-red-500 text-white px-4 py-2 rounded mr-2",onClick:()=>{console.log("Deleting order:",n),(0,i.s)(n.id).then((()=>{console.log("Order deleted successfully"),c(!1)})).catch((e=>{console.error("Error deleting order:",e)}))},children:"Delete"}),(0,A.jsx)("button",{className:"bg-gray-300 text-gray-700 px-4 py-2 rounded",onClick:()=>c(!1),children:"Cancel"})]})]})}),x&&(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50",children:(0,A.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,A.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Order Details"}),Array.isArray(n.items)?(0,A.jsxs)("div",{className:"max-h-[200px] overflow-y-auto",children:[" ",(0,A.jsx)("ul",{children:n.items.map(((e,s)=>(0,A.jsxs)("li",{className:"flex flex-row justify-between",children:[(0,A.jsx)("img",{src:e.image,alt:e.productName,className:"w-[70px] h-[70px]"}),(0,A.jsx)("p",{children:e.productName}),(0,A.jsxs)("p",{children:["GHc ",e.productPrice]}),(0,A.jsxs)("p",{children:["Qty: ",e.quantity]})]},s)))})]}):(0,A.jsx)("p",{children:"No items found."}),(0,A.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,A.jsx)("button",{className:"bg-green-500 text-white px-4 py-2 rounded mr-2",onClick:()=>{console.log("Marking order as paid:",n),(0,i.wA)(n.id).then((()=>{console.log("Order marked as paid successfully"),u(!1)})).catch((e=>{console.error("Error marking order as paid:",e)}))},children:"Mark as Paid"}),(0,A.jsx)("button",{className:"bg-green-500 text-white px-4 py-2 rounded mr-2",onClick:()=>{console.log("Marking order as delivered:",n),(0,i.Om)(n.id).then((()=>{console.log("Order marked as delivered successfully"),u(!1)})).catch((e=>{console.error("Error marking order as delivered:",e)}))},children:"Mark as Delivered"}),(0,A.jsx)("button",{className:"bg-gray-300 text-gray-700 px-4 py-2 rounded",onClick:()=>u(!1),children:"Cancel"})]})]})})]})};var S=t(2628);const P=e=>{let{categories:s}=e;const[t,l]=(0,r.useState)(""),[a,c]=(0,r.useState)(""),[o,n]=(0,r.useState)(""),[d,x]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),[j,b]=(0,r.useState)(null),[y,f]=(0,r.useState)(null),[N,w]=(0,r.useState)(!1),{currentUser:v,userLoggedIn:k}=(0,m.A)(),C=k&&v?v.uid:null;return(0,A.jsxs)("form",{className:"space-y-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-70",children:"Select Category"}),(0,A.jsx)("select",{value:t,onChange:e=>l(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:s.map(((e,s)=>(0,A.jsx)("option",{value:e,children:(0,A.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,A.jsx)("div",{className:"w-4 h-4 rounded-full bg-".concat(s%3===0?"blue":s%3===1?"green":"yellow","-500")}),(0,A.jsx)("span",{children:e})]})},s)))})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-7000",children:"Product Location"}),(0,A.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Product Name"}),(0,A.jsx)("input",{type:"text",value:a,onChange:e=>c(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Product Price"}),(0,A.jsx)("input",{type:"number",value:o,onChange:e=>n(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),(0,A.jsx)("input",{type:"number",value:g,onChange:e=>p(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Product Details"}),(0,A.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,A.jsxs)("div",{className:"mt-2",children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Upload Product Image"}),(0,A.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const s=e.target.files[0];b(s),f(URL.createObjectURL(s))},className:"mt-1 block w-full text-sm text-gray-500"}),y&&(0,A.jsx)("div",{className:"mt-2",children:(0,A.jsx)("img",{src:y,alt:"Product Preview",className:"w-36 h-36 object-cover"})})]}),(0,A.jsx)("div",{className:"w-full",children:(0,A.jsx)("button",{type:"button",onClick:async()=>{if(t&&a&&o&&g&&j&&d)try{w(!0);const e=await(0,i.iG)(j),s={userId:C,category:t,productName:a,productPrice:o,productLocation:d,productDetails:u,quantity:g,image:e};await(0,i.k2)(s).then((()=>{alert("Product added successfully")})).catch((e=>{console.error("Error adding product:",e),alert("Error adding product")})),c(""),n(""),x(""),h(""),p(""),b(null),f(null)}catch(e){console.error("Error adding product:",e),alert("Error adding product")}finally{w(!1)}else alert("Please fill in all fields and upload an image.")},className:"w-full py-2 px-4 bg-violet-600 text-white rounded-md shadow-sm hover:bg-yellow-600",children:N?"Adding Product...":"Add Product"})})]})},E=e=>{let{userId:s}=e;const[t,m]=(0,r.useState)([]),[u,h]=(0,r.useState)(!1),[g,p]=(0,r.useState)(!1),[j,b]=(0,r.useState)(!1),y=((0,x.wA)(),e=>{h(!1),(async e=>{try{p(!0),await(0,i.TZ)(e),m(t.filter((s=>s.id!==e))),b(!j)}catch(s){console.error("Error deleting product:",s)}finally{p(!1)}})(e)});return(0,r.useEffect)((()=>{s&&(async()=>{try{const e=await(0,i.LR)(s);m(e)}catch(e){console.error("Error fetching products:",e)}})()}),[s,j]),(0,A.jsxs)("div",{className:"p-4",children:[(0,A.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Added Products"}),(0,A.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Tap the X button to remove products"}),t.map(((e,s)=>(0,A.jsxs)("div",{className:"relative flex mb-4 border rounded-md shadow-sm",children:[(0,A.jsx)("img",{src:e.image,alt:e.productName,className:"w-36 h-36 object-cover"}),(0,A.jsxs)("div",{className:"flex flex-col p-4 truncate",children:[(0,A.jsx)("h3",{className:"text-lg font-medium truncate",children:e.productName}),(0,A.jsxs)("p",{className:"text-sm text-gray-500",children:["GHC ",e.productPrice]}),(0,A.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.productLocation}),(0,A.jsxs)("p",{className:"text-sm text-gray-500",children:["Q: ",e.quantity]})]}),(0,A.jsx)("button",{type:"button",onClick:()=>{h(!0)},className:"absolute top-2 right-2 text-red-500 hover:text-red-700",children:(0,A.jsx)(S.A,{className:"h-7 w-7"})}),(0,A.jsxs)(l.A,{className:"rounded-[20px]",open:u,onClose:()=>h(!1),children:[(0,A.jsx)(a.A,{className:"font-bold text-sm",children:"Are you sure you want to delete this product ?"}),(0,A.jsx)(c.A,{children:(0,A.jsx)(o.A,{className:"text-gray-500 text-sm",children:"Click the Confirm button to delete this product."})}),(0,A.jsxs)(n.A,{children:[(0,A.jsx)(d.A,{onClick:()=>h(!1),className:"w-full btn bg-gray-300 hover:bg-gray-500 hover:text-white text-black md:ml-4 font-semibold px-3 py-2 rounded-[10px] duration-500",children:"Cancel"}),(0,A.jsx)(d.A,{onClick:()=>y(e.id),disabled:g,className:"w-full btn bg-violet-600 text-white hover:bg-green-600 hover:text-white md:ml-4 font-semibold px-3 py-2 rounded-[10px] duration-500",children:g?"Please wait...":"Confirm"})]})]})]},s)))]})},D=()=>{const[e,s]=(0,r.useState)([]),{currentUser:t,userLoggedIn:l}=(0,m.A)(),a=l&&t?t.uid:null;return(0,r.useEffect)((()=>{(async()=>{try{const e=await(0,i.wV)();s(e)}catch(e){console.error("Error fetching categories:",e)}})()}),[]),(0,A.jsx)("div",{className:"container mx-auto mt-4 mb-4",children:(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,A.jsx)("div",{className:"md:col-span-2 shadow-xl",children:(0,A.jsx)("div",{className:"p-4 bg-white rounded-md shadow-sm",children:(0,A.jsx)(P,{categories:e})})}),(0,A.jsx)("div",{className:"md:col-span-1 shadow-xl",children:(0,A.jsx)("div",{className:"p-4 bg-white rounded-md shadow-sm",children:(0,A.jsx)(E,{userId:a})})})]})})};var L=t(6491);const O={backgroundColor:"white",padding:"40px",margin:"8px 0",borderRadius:"10px"},I=()=>{const{currentUser:e,userLoggedIn:s}=(0,m.A)(),t=s&&e?e.uid:null,[l,a]=(0,r.useState)([]),[c,n]=(0,r.useState)([]);(0,r.useEffect)((()=>{t&&(0,i.Et)(t).then((e=>{a(e),console.log(e)})).catch((e=>{console.error("Error fetching orders:",e)}))}),[t]),(0,r.useEffect)((()=>{t&&(0,i.LR)(t).then((e=>{n(e),console.log(e)})).catch((e=>{console.error("Error fetching products:",e)}))}),[t]);const d=l.reduce(((e,s)=>e+s.items.length),0),x=c.length,u=l.filter((e=>"paid"===e.paymentStatus)),h=u.length,g=h>0?u.reduce(((e,s)=>e+parseFloat(s.totalAmount||0)),0):0;return(0,A.jsx)("div",{className:"",children:(0,A.jsxs)("div",{children:[(0,A.jsx)(o.A,{variant:"h2",gutterBottom:!0,className:"font-bold text-xl",children:"Summary"}),(0,A.jsxs)(L.A,{className:"flex flex-wrap -mx-2",children:[(0,A.jsxs)(L.A,{className:"shadow-xl shadow-black-600 w-full md:w-1/5 px-2 mb-4 mr-5",sx:{...O},children:[(0,A.jsx)("p",{className:"mb-2",children:"Total Orders"}),(0,A.jsx)("p",{className:"mb-2 font-bold",children:d}),(0,A.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,A.jsx)("span",{className:"text-blue-700",children:"Approved"})," orders"]})]}),(0,A.jsxs)(L.A,{className:"shadow-xl shadow-black-600 w-full md:w-3/5 px-2 mb-4",sx:{...O},children:[(0,A.jsx)("p",{className:"mb-2",children:"Completed Orders"}),(0,A.jsx)("p",{className:"mb-2 font-bold",children:h}),(0,A.jsxs)("p",{className:"text-sm text-gray-500",children:["Audited and ",(0,A.jsx)("span",{className:"text-blue-700",children:"paid"})," orders"]})]}),(0,A.jsxs)(L.A,{className:"shadow-xl shadow-black-600 w-full md:w-1/5 px-2 mb-4 mr-5",sx:{...O},children:[(0,A.jsx)("p",{className:"mb-2",children:"Total Products Added"}),(0,A.jsx)("p",{className:"text-xl text-gray-50",children:(0,A.jsx)("span",{className:"text-green-500",children:x})})]}),(0,A.jsxs)(L.A,{className:"shadow-xl shadow-black-600 w-full md:w-3/5 px-2 mb-4",sx:{...O},children:[(0,A.jsx)("p",{className:"mb-2",children:"Total Revenue"}),(0,A.jsx)("p",{className:"text-xl text-gray-50",children:(0,A.jsxs)("span",{className:"text-green-500",children:["GHC ",g.toFixed(2)]})})]})]})]})})},R=()=>{const e=(0,x.wA)(),[s,t]=(0,r.useState)(!1),{currentUser:h,userLoggedIn:g}=(0,m.A)(),p=g&&h?h.uid:null;(0,r.useEffect)((()=>{(0,i.VL)(p).then((e=>{t(e.seller)})),console.log(s)}),[e,p,s]);const[j,b]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[N,w]=(0,r.useState)("Purchases");return(0,A.jsxs)("div",{className:"flex flex-col items-center justify-center p-0 md:p-1",children:[!s&&(0,A.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 max-w-sm text-center",children:[(0,A.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Become A Seller"}),(0,A.jsx)("p",{className:"text-gray-600 mb-4",children:"Register as a seller also and start selling your products for profit"}),(0,A.jsx)("button",{className:"bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-700",onClick:()=>{b(!0)},children:"Become A Seller"})]}),s&&(0,A.jsxs)("div",{className:"w-full p-4",children:[(0,A.jsxs)("div",{className:"flex flex-row space-x-4 mb-6",children:[(0,A.jsx)(u.A,{label:"Purchases",isActive:"Purchases"===N,onClick:()=>w("Purchases")}),(0,A.jsx)(u.A,{label:"Products",isActive:"Products"===N,onClick:()=>w("Products")}),(0,A.jsx)(u.A,{label:"Summary",isActive:"Summary"===N,onClick:()=>w("Summary")})]}),(()=>{switch(N){case"Purchases":return(0,A.jsx)(C,{});case"Products":return(0,A.jsx)(D,{});case"Summary":return(0,A.jsx)(I,{});default:return null}})()]}),(0,A.jsxs)(l.A,{className:"rounded-[20px]",open:j,onClose:()=>b(!1),children:[(0,A.jsx)(a.A,{className:"font-bold text-sm",children:"Are you sure you want to become a seller ?"}),(0,A.jsx)(c.A,{children:(0,A.jsx)(o.A,{className:"text-gray-500 text-sm",children:"Click the Confirm button to start putting your products for sale\ud83c\udf8a."})}),(0,A.jsxs)(n.A,{children:[(0,A.jsx)(d.A,{onClick:()=>b(!1),className:"w-full btn bg-gray-300 hover:bg-gray-500 hover:text-white text-black md:ml-4 font-semibold px-3 py-2 rounded-[10px] duration-500",children:"Cancel"}),(0,A.jsx)(d.A,{onClick:async s=>{b(!1),f(!0),s.preventDefault();try{e((0,i.Rv)(p)),alert("You have successfully become a seller!")}catch(t){console.error("Error becoming a seller:",t),alert("Error becoming a seller, try again...")}finally{f(!1)}},disabled:y,className:"w-full btn bg-violet-600 text-white hover:bg-green-600 hover:text-white md:ml-4 font-semibold px-3 py-2 rounded-[10px] duration-500",children:y?"Please wait...":"Confirm"})]})]})]})}}}]);